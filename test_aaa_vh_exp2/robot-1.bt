fallback
    condition IsIn(milk,box)
    fallback
        sequence
            condition IsSelfTask(frozenset({'IsIn(milk,box)'}))
            action WalkToPutMilkInBox()
            action FinishTask()
        sequence
            fallback
                condition IsOpen(box) & IsRightHandEmpty(agent-1)
                sequence
                    condition IsNear(agent-1,fridge) & IsOpen(box) & IsOpen(fridge) & IsRightHolding(agent-1,box)
                    action RightPutIn(agent-1,box,fridge)
                sequence
                    condition IsNear(agent-1,box) & IsOpen(box) & IsRightHolding(agent-1,box)
                    action RightPutIn(agent-1,box,box)
                sequence
                    condition IsNear(agent-1,fridge) & IsOpen(box) & IsOpen(fridge) & IsRightHolding(agent-1,milk)
                    action RightPutIn(agent-1,milk,fridge)
            action SelfAcceptTask(frozenset({'IsIn(milk,box)'}))
    sequence
        condition IsNear(agent-1,box) & IsOpen(box) & IsRightHolding(agent-1,milk)
        action RightPutIn(agent-1,milk,box)
    fallback
        condition IsClose(box) & IsLeftHandEmpty(agent-0) & IsRightHandEmpty(agent-1)
        sequence
            condition IsClose(box) & IsLeftHandEmpty(agent-0) & IsNear(agent-1,fridge) & IsOpen(fridge) & IsRightHolding(agent-1,box)
            action RightPutIn(agent-1,box,fridge)
        sequence
            condition IsClose(box) & IsLeftHandEmpty(agent-0) & IsNear(agent-1,fridge) & IsOpen(fridge) & IsRightHolding(agent-1,milk)
            action RightPutIn(agent-1,milk,fridge)
