fallback
    condition IsIn(book,bookshelf) & IsOn(toy,bookshelf)
    sequence
        fallback
            condition IsNear(agent-2,bookshelf) & IsOn(toy,bookshelf) & IsRightHolding(agent-2,book)
            sequence
                condition IsOn(toy,bookshelf) & IsRightHolding(agent-2,book)
                action Walk(agent-2,bookshelf)
        action RightPutIn(agent-2,book,bookshelf)
    sequence
        fallback
            condition IsOn(toy,bookshelf) & IsRightHandEmpty(agent-2)
            sequence
                fallback
                    condition IsNear(agent-2,bookshelf) & IsOn(toy,bookshelf) & IsRightHolding(agent-2,toy)
                    sequence
                        condition IsOn(toy,bookshelf) & IsRightHolding(agent-2,toy)
                        action Walk(agent-2,bookshelf)
                action RightPutIn(agent-2,toy,bookshelf)
        action WalkToPutBookInBookshelf()
    sequence
        condition IsNear(agent-0,bookshelf) & IsRightHandEmpty(agent-2) & IsRightHolding(agent-0,toy)
        action WalkToPutBookInBookshelf()
    sequence
        fallback
            condition IsNear(agent-2,bookshelf) & IsRightHandEmpty(agent-3) & IsRightHolding(agent-2,book)
            sequence
                condition IsRightHandEmpty(agent-3) & IsRightHolding(agent-2,book)
                action Walk(agent-2,bookshelf)
        action RightPutIn(agent-2,book,bookshelf)
    sequence
        condition IsRightHandEmpty(agent-2) & IsRightHandEmpty(agent-3)
        action WalkToPutBookInBookshelf()
    sequence
        fallback
            condition IsNear(agent-2,bookshelf) & IsRightHandEmpty(agent-1) & IsRightHolding(agent-2,book)
            sequence
                condition IsRightHandEmpty(agent-1) & IsRightHolding(agent-2,book)
                action Walk(agent-2,bookshelf)
        action RightPutIn(agent-2,book,bookshelf)
    sequence
        condition IsRightHandEmpty(agent-1) & IsRightHandEmpty(agent-2)
        action WalkToPutBookInBookshelf()
    sequence
        fallback
            condition IsNear(agent-2,bookshelf) & IsRightHandEmpty(agent-0) & IsRightHolding(agent-2,book)
            sequence
                condition IsRightHandEmpty(agent-0) & IsRightHolding(agent-2,book)
                action Walk(agent-2,bookshelf)
        action RightPutIn(agent-2,book,bookshelf)
    sequence
        condition IsRightHandEmpty(agent-0) & IsRightHandEmpty(agent-2)
        action WalkToPutBookInBookshelf()
    sequence
        condition IsNear(agent-3,bookshelf) & IsRightHandEmpty(agent-2) & IsRightHolding(agent-3,toy)
        action WalkToPutBookInBookshelf()
    sequence
        condition IsNear(agent-1,bookshelf) & IsRightHandEmpty(agent-2) & IsRightHolding(agent-1,toy)
        action WalkToPutBookInBookshelf()
    sequence
        condition IsNear(agent-0,bookshelf) & IsRightHandEmpty(agent-2) & IsRightHolding(agent-0,book)
        action WalkToPutBookInBookshelf()
